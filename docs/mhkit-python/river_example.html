

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MHKiT River Module &mdash; MHKiT v0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/mhkit.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MHKiT
          

          
          </a>

          
            
            
              <div class="version">
                v0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qc.html">QC Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wave.html">Wave Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../river.html">River Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tidal.html">Tidal Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">Utils Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python.html">MHKiT-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab.html">MHKiT-MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Online Forum</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MHKiT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>MHKiT River Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/mhkit-python/river_example.nblink.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="MHKiT-River-Module">
<h1>MHKiT River Module<a class="headerlink" href="#MHKiT-River-Module" title="Permalink to this headline">¶</a></h1>
<p>The following example will familiarize the user with the <a class="reference external" href="https://mhkit-software.github.io/MHKiT/mhkit-python/api.river.html">MHKIT river module</a> by stepping through the calculation of annual energy produced for one turbine in the Tanana river near Nenana, Alaska. The data file used in this example is retrieved from the USGS website, additional data is stored in the
<cite>\MHKiT:nbsphinx-math:</cite>examples`:nbsphinx-math:<cite>data</cite> &lt;<a class="reference external" href="https://github.com/MHKiT-Software/MHKiT-Python/tree/master/examples/data">https://github.com/MHKiT-Software/MHKiT-Python/tree/master/examples/data</a>&gt;`__ directory.</p>
<p>Start by importing the necessary python packages and MHKiT module.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">mhkit</span> <span class="kn">import</span> <span class="n">river</span>
</pre></div>
</div>
</div>
<div class="section" id="Importing-Data-from-USGS">
<h2>Importing Data from USGS<a class="headerlink" href="#Importing-Data-from-USGS" title="Permalink to this headline">¶</a></h2>
<p>We will start by requesting daily discharge data from the USGS website for the Tanana River near Nenana, Alaska. The function <code class="docutils literal notranslate"><span class="pre">request_usgs_data</span></code> in the river IO module returns a Pandas DataFrame. The function requires the station number, parameter number, timeframe, and type of data.</p>
<p>The station number can be found on the USGS website, though this is more difficult than searching the web for “USGS Tanana near Nenana” which should return a link to <a class="reference external" href="https://waterdata.usgs.gov/nwis/inventory/?site_no=15515500">https://waterdata.usgs.gov/nwis/inventory/?site_no=15515500</a>. This page contains an overview of the available data, including daily discharge data.</p>
<p>The IEC standard recommends 10 years of daily discharge data for calculations of annual energy produced (AEP). The timeframe shows that at least 10 years of data is available. Clicking on the “Daily Data” will bring up a page that would allow the user to request data from the site. Each of the “Available Parameters” has a 5 digit code in front of it which will depend on the data type and reported units. The user at this point could use the website to download the data, however, the
<code class="docutils literal notranslate"><span class="pre">request_usgs_data</span></code> function is used here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Use the requests method to obtain 10 years of daily discharge data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">request_usgs_data</span><span class="p">(</span><span class="n">station</span><span class="o">=</span><span class="s2">&quot;15515500&quot;</span><span class="p">,</span>
                            <span class="n">parameter</span><span class="o">=</span><span class="s1">&#39;00060&#39;</span><span class="p">,</span>
                            <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2009-08-01&#39;</span><span class="p">,</span>
                            <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2019-08-01&#39;</span><span class="p">,</span>
                            <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;Daily&#39;</span><span class="p">)</span>

<span class="c1"># Print data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Data request URL:  https://waterservices.usgs.gov/nwis/dv/?format=json&amp;sites=15515500&amp;startDT=2009-08-01&amp;endDT=2019-08-01&amp;statCd=00003&amp;parameterCd=00060&amp;siteStatus=all
                           Discharge, cubic feet per second
2009-08-01 00:00:00+00:00                             59100
2009-08-02 00:00:00+00:00                             59700
2009-08-03 00:00:00+00:00                             56200
2009-08-04 00:00:00+00:00                             51700
2009-08-05 00:00:00+00:00                             52100
...                                                     ...
2019-07-28 00:00:00+00:00                             66000
2019-07-29 00:00:00+00:00                             63900
2019-07-30 00:00:00+00:00                             63500
2019-07-31 00:00:00+00:00                             64700
2019-08-01 00:00:00+00:00                             64600

[3653 rows x 1 columns]
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">request_usgs_data</span></code> function returned a pandas DataFrame indexed by time. For this example, the column name “Discharge, cubic feet per second” is long and therefore is renamed to “Q”. Furthermore, MHKiT expects all units to be in SI so the discharge values is converted to <img class="math" src="../_images/math/c2e557c37814c2f967a4d7103cc65ae4aaa4a0e4.png" alt="m^3/s"/>. Finally, we can plot the discharge time series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Store the original DataFrame column name</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Rename to a shorter key name e.g. &#39;Q&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">column_name</span><span class="p">:</span> <span class="s1">&#39;Q&#39;</span><span class="p">})</span>

<span class="c1"># Convert to discharge data from ft3/s to m3/s</span>
<span class="n">data</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.28084</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>

<span class="c1"># Plot the daily discharge</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_discharge_timeseries</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/mhkit-python_river_example_5_0.png" src="../_images/mhkit-python_river_example_5_0.png" />
</div>
</div>
</div>
<div class="section" id="Flow-Duration-Curve">
<h2>Flow Duration Curve<a class="headerlink" href="#Flow-Duration-Curve" title="Permalink to this headline">¶</a></h2>
<p>The flow duration curve (FDC) is a plot of discharge versus exceedance probability which quantifies the percentage of time that the discharge in a river exceeds a particular magnitude. The curve is typically compiled on a monthly or annual basis.</p>
<p>The exceedance probability for the highest discharge is close to 0%, since that value is rarely exceeded. Conversely, the lowest discharge are found closer to 100% as they are most often exceeded.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate exceedence probability</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">exceedance_probability</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>

<span class="c1"># Plot the flow duration curve (FDC)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_flow_duration_curve</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/mhkit-python_river_example_7_0.png" src="../_images/mhkit-python_river_example_7_0.png" />
</div>
</div>
</div>
<div class="section" id="Velocity-Duration-Curve">
<h2>Velocity Duration Curve<a class="headerlink" href="#Velocity-Duration-Curve" title="Permalink to this headline">¶</a></h2>
<p>At each river energy converter location we must provide a curve that relates the velocity at the turbine location to the river discharge levels. IEC 301 recommends using at least 15 different discharges and that only velocities within the turbine operating conditions need to be included.</p>
<p>Here we only provide 6 different discharge to velocities relationships created using a hydrological model. The data is loaded into a pandas DataFrame using the pandas method <code class="docutils literal notranslate"><span class="pre">read_csv</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Load discharge to velocity curve at turbine location</span>
<span class="n">DV_curve</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/tanana_DV_curve.csv&#39;</span><span class="p">)</span>

<span class="c1"># Create a polynomial fit of order 2 from the discharge to velocity curve.</span>
<span class="c1"># Return the polynomial fit and and R squared value</span>
<span class="n">p</span><span class="p">,</span> <span class="n">r_squared</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">polynomial_fit</span><span class="p">(</span><span class="n">DV_curve</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="n">DV_curve</span><span class="o">.</span><span class="n">V</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot the polynomial curve</span>
<span class="n">river</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_discharge_vs_velocity</span><span class="p">(</span><span class="n">DV_curve</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="n">DV_curve</span><span class="o">.</span><span class="n">V</span><span class="p">,</span> <span class="n">polynomial_coeff</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># Print R squared value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9971199490337133
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/mhkit-python_river_example_9_1.png" src="../_images/mhkit-python_river_example_9_1.png" />
</div>
</div>
<p>The IEC standard recommends a polynomial fit of order 3. By changing the order above and replotting the polynomial fit to the curve data it can be seen this is not a good fit for the provided data. Therefore the order was set to 2.</p>
<p>Next, we calculate velocity for each discharge using the polynomial and plot the VDC.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Use polynomial fit from DV curve to calculate velocity (&#39;V&#39;) from discharge at turbine location</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">discharge_to_velocity</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># Plot the velocity duration curve (VDC)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_velocity_duration_curve</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">V</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">F</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/mhkit-python_river_example_11_0.png" src="../_images/mhkit-python_river_example_11_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Power-Duration-Curve">
<h1>Power Duration Curve<a class="headerlink" href="#Power-Duration-Curve" title="Permalink to this headline">¶</a></h1>
<p>The power duration curve is created in a nearly identical manner to the VDC. Here, a velocity to power curve is used to create a polynomial fit. The polynomial fit is used to calculate the power produced between the turbine cut-in and cut-out velocities. The velocity to power curve data is loaded into a pandas DataFrame using the pandas method <code class="docutils literal notranslate"><span class="pre">read_csv</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate the power produced from turbine velocity to power curve</span>
<span class="n">VP_curve</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/tanana_VP_curve.csv&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the polynomial fit for the VP curve</span>
<span class="n">p2</span><span class="p">,</span> <span class="n">r_squared_2</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">polynomial_fit</span><span class="p">(</span><span class="n">VP_curve</span><span class="o">.</span><span class="n">V</span><span class="p">,</span> <span class="n">VP_curve</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot the VP polynomial curve</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_velocity_vs_power</span><span class="p">(</span><span class="n">VP_curve</span><span class="o">.</span><span class="n">V</span><span class="p">,</span> <span class="n">VP_curve</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">polynomial_coeff</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>

<span class="c1"># Print the r_squared value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r_squared_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9994550455214498
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/mhkit-python_river_example_13_1.png" src="../_images/mhkit-python_river_example_13_1.png" />
</div>
</div>
<p>The second-order polynomial fits the data well. Therefore, the polynomial is used to calculate the power using the min and max of the curves velocities as the turbine operational limits.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate power from velocity at the turbine location</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">velocity_to_power</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">V</span><span class="p">,</span>
                                     <span class="n">polynomial_coefficients</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span>
                                     <span class="n">cut_in</span><span class="o">=</span><span class="n">VP_curve</span><span class="o">.</span><span class="n">V</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                     <span class="n">cut_out</span><span class="o">=</span><span class="n">VP_curve</span><span class="o">.</span><span class="n">V</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="c1"># Plot the power duration curve</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_power_duration_curve</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/mhkit-python_river_example_15_0.png" src="../_images/mhkit-python_river_example_15_0.png" />
</div>
</div>
<div class="section" id="Annual-Energy-Produced">
<h2>Annual Energy Produced<a class="headerlink" href="#Annual-Energy-Produced" title="Permalink to this headline">¶</a></h2>
<p>Finally, annual energy produced is computed, as shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate the Annual Energy produced</span>
<span class="n">s</span> <span class="o">=</span> <span class="mf">365.</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span> <span class="c1"># Seconds in a year</span>
<span class="n">AEP</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">energy_produced</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Annual Energy Produced: {AEP/1000000:.2f} MW&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Annual Energy Produced: 19.07 MW
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, National Renewable Energy Laboratory, Pacific Northwest National Laboratory, and Sandia National Laboratories

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-164358105-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>